{% include base_path %}
{%- assign pages_list = site[page.collection] | default: site.html_pages -%}

{%- assign parent_page = nil -%}
{%- assign grandparent_page = nil -%}
{%- assign permalink_array = page.permalink | split: '/' -%}

{%- for node in pages_list -%}

  {% if permalink_array[2] == "node.title | downcase" %}
    {%- assign parent_page = node -%}
  {% endif %}

  {% if permalink_array[1] == "node.title | downcase" %}
    {%- assign grandparent_page = node -%}
  {% endif %}

  {%- if parent_page != nil and grandparent_page != nil -%}
    {%- break -%}
  {%- endif -%}

{%- endfor -%}

<nav aria-label="Breadcrumb" class="breadcrumbs">
  <ol>
    {% if parent_page != nil -%}
      {%- if grandparent_page != nil %}
        <li><a href="{{ base_path }}{{ grandparent_page.permalink }}">{{ grandparent_page.title }}</a></li>
      {%- endif %}
      <li><a href="{{ base_path }}{{ parent_page.permalink }}">{{ parent_page.title }}</a></li>
    {% endif -%}
    <li><span>{{ page.title }}</span></li>
  </ol>
</nav>