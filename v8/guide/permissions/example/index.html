

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Permissions example - Ontimize Web</title>







<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Ontimize Web">
<meta property="og:title" content="Permissions example">


  <link rel="canonical" href="https://ontimizeweb.github.io/docs/v8/guide/permissions/example/">
  <meta property="og:url" content="https://ontimizeweb.github.io/docs/v8/guide/permissions/example/">



  <meta property="og:description" content="     On This Page  ">



  <meta name="twitter:site" content="@imatiainnova">
  <meta name="twitter:title" content="Permissions example">
  <meta name="twitter:description" content="     On This Page  ">
  <meta name="twitter:url" content="https://ontimizeweb.github.io/guide/permissions/example/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="https://ontimizeweb.github.io/docs/v8/images/site-logo.png">
    
  

  



  

  



  <meta property="og:image" content="https://ontimizeweb.github.io/docs/v8/images/site-logo.png">



  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2024-04-05T03:41:07-04:00">






  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "url": "https://ontimizeweb.github.io/docs/v8",
      "logo": "https://ontimizeweb.github.io/docs/v8/images/site-logo.png"
    }
  </script>



  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Ontimize Web",
      "url" : "https://ontimizeweb.github.io/docs/v8",
      "sameAs" : ["https://twitter.com/imatiainnova"]
    }
  </script>






<!-- end SEO -->


<link href="https://ontimizeweb.github.io/docs/v8/feed.xml" type="application/atom+xml" rel="alternate" title="Ontimize Web Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script defer src="https://ontimizeweb.github.io/docs/v8/assets/js/fontawesome-all.min.js"></script>

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="https://ontimizeweb.github.io/docs/v8/assets/css/main.css">
<link href="https://fonts.googleapis.com/css?family=PT+Sans" rel="stylesheet">
<meta http-equiv="cleartype" content="on">
    

<!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="https://ontimizeweb.github.io/docs/v8/images/apple-icon-57x57.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="60x60" href="https://ontimizeweb.github.io/docs/v8/images/apple-icon-60x60.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="72x72" href="https://ontimizeweb.github.io/docs/v8/images/apple-icon-72x72.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="76x76" href="https://ontimizeweb.github.io/docs/v8/images/apple-icon-76x76.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="114x114" href="https://ontimizeweb.github.io/docs/v8/images/apple-icon-114x114.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="120x120" href="https://ontimizeweb.github.io/docs/v8/images/apple-icon-120x120.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="144x144" href="https://ontimizeweb.github.io/docs/v8/images/apple-icon-144x144.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="152x152" href="https://ontimizeweb.github.io/docs/v8/images/apple-icon-152x152.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="180x180" href="https://ontimizeweb.github.io/docs/v8/images/apple-icon-180x180.png?v=M44lzPylqQ">
<link rel="icon" type="image/png" href="https://ontimizeweb.github.io/docs/v8/images/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32">
<link rel="icon" type="image/png" href="https://ontimizeweb.github.io/docs/v8/images/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96">
<link rel="icon" type="image/png" href="https://ontimizeweb.github.io/docs/v8/images/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16">
<link rel="icon" type="image/png" href="https://ontimizeweb.github.io/docs/v8/images/android-icon-192x192.png?v=M44lzPylqQ" sizes="192x192">
<link rel="manifest" href="https://ontimizeweb.github.io/docs/v8/images/manifest.json?v=M44lzPylqQ">
<link rel="shortcut icon" href="/images/favicon.ico?v=M44lzPylqQ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="https://ontimizeweb.github.io/docs/v8/images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="https://ontimizeweb.github.io/docs/v8/images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
          <a href="https://ontimizeweb.github.io/docs/v8/">
            <div class="main_icon"></div>
        </a>

        <script src="https://ontimizeweb.github.io/docs/v8/assets/js/lunr.js"></script>
<script type="text/javascript" src="/docs/v8/assets/js/ontimize.js"></script>

<div class="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Ontimize Web" aria-label="Search Ontimize Web"
      autocomplete="off">
    <label for="search-input" class="search-label">
      <i class="fa fa-fw fa-search search-icon" aria-hidden="true"></i>
    </label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>



<div class="search-overlay"></div>



        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <!--<li class="masthead__menu-item masthead__menu-item--lg"><a href="https://ontimizeweb.github.io/docs/v8/">Ontimize Web</a></li>-->
          
            



            
              <li class="masthead__menu-item"><a href="https://ontimizeweb.github.io/docs/v8/doc-overview/">Getting started</a>
            
            </li>


            
              <div class="masthead__menu-separator"></div>
            

          
            



            
              <li class="masthead__menu-item"><a href="https://ontimizeweb.github.io/docs/v8/components/">Components</a>
            
            </li>


            
              <div class="masthead__menu-separator"></div>
            

          
            



            
              <li class="masthead__menu-item"><a href="https://ontimizeweb.github.io/docs/v8/about/">About</a>
            
            </li>


            
            

          

          
          <li class="masthead__menu-item masthead__menu-item-active">
            <select onchange="window.location = this.options[this.selectedIndex].value">
            
              <option value="https://ontimizeweb.github.io/docs/v4" >4.x.x</option>
            
              <option value="https://ontimizeweb.github.io/docs/v8"  selected="selected" >8.x.x</option>
            
              <option value="https://ontimizeweb.github.io/docs/v15" >15.x.x</option>
            
            </select>
          </li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  


  <div class="sidebar sticky">
  
  
    
      
      
      
    
    
      


 <script type="text/javascript" style="display:none;">
  var onNavigationItemClick = function (element) {

    var parentNav = $(element).parents('nav.nav__list');
    var icons = parentNav.find('svg');
    icons.addClass('fa-folder');
    icons.addClass('orange-icon');
    icons.removeClass('fa-folder-open');

    var parentLi = $(element).parents('li.nav-component-category:first');
    parentLi.siblings().removeClass('active-component-category');
    parentLi.addClass('active-component-category');
/*
    parentLi.siblings(':not(.active-parent)').removeClass('active-component-category');
    parentLi.toggleClass('active-component-category');
*/    
    var currentIcon = parentLi.find('svg:first');
    currentIcon.addClass('fa-folder-open');
    currentIcon.removeClass('orange-icon');
    currentIcon.removeClass('fa-folder');

  };
</script>

<nav class="nav__list">
  
  <ul>
    
    
    
      
          
              
                  
              
                  
              
                  
              
                  
              
                  
              
                 
      
          
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                 
      
          
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                 
      
          
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                  
              
                 
      
          
              
                  
              
                  
              
                  
              
                  
              
                  
              
                 
      
    
 
    

    

    
    

      
       
      <li class="nav-component-category ">
        
          
            <span class="nav__sub-title"  onclick="onNavigationItemClick(this)"><i class="far fa-folder orange-icon nav__sub-title-icon"></i>Getting Started</span>
          

        

        
        <ul class="category-components-list">
          

          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/doc-overview/" class=" ">Document overview</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/example-overview/" class=" ">Example overview</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/install-and-run/" class=" ">Run an example</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/make-changes/" class=" ">Make some changes</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/advanced-changes/" class=" ">Advanced topics</a></li>
          
        </ul>
        
      </li>
    
    

      
       
      <li class="nav-component-category ">
        
          
            <span class="nav__sub-title"  onclick="onNavigationItemClick(this)"><i class="far fa-folder orange-icon nav__sub-title-icon"></i>Guide</span>
          

        

        
        <ul class="category-components-list">
          

          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/guide/appstructure/" class=" ">App structure</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/guide/appconfig/" class=" ">App configuration</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/app-modules/" class=" ">Modules</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/routing/" class=" ">Routing</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/forms/" class=" ">Forms</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/guide/service/" class=" ">Services</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/guide/permissions/" class=" ">Permissions</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/run-your-app/" class=" ">Run your app</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/deployment/" class=" ">Deploy your app</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/add-to-project/" class=" ">OntimizeWeb library</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/video-examples/" class=" ">Video examples</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/migrations/" class=" ">Migration guides</a></li>
          
        </ul>
        
      </li>
    
    

      
       
      <li class="nav-component-category ">
        
          
            <span class="nav__sub-title"  onclick="onNavigationItemClick(this)"><i class="far fa-folder orange-icon nav__sub-title-icon"></i>Customization</span>
          

        

        
        <ul class="category-components-list">
          

          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/customize/theming/" class=" ">Theming</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/customize/theming/migration" class=" ">Theming migration</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/customize/typography/" class=" ">Typography</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/customize/style-guide/" class=" ">Style guide</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/customize/icons/" class=" ">Icons</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/customize/tabs/" class=" ">Tabs</a></li>
          
        </ul>
        
      </li>
    
    

      
       
      <li class="nav-component-category ">
        
          
            <span class="nav__sub-title"  onclick="onNavigationItemClick(this)"><i class="far fa-folder orange-icon nav__sub-title-icon"></i>Add-ons</span>
          

        

        
        <ul class="category-components-list">
          

          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/ontimize-web-ngx-tools/" class=" ">Tools</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/theming/" class=" ">Theming</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/ontimize-web-ngx-datatable/" class=" ">DataTable <small>(deprecated)</small></a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/charts/" class=" ">Charts <span class='menuitem-badge'>new<span></a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/map/" class=" ">Map</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/ontimize-web-ngx-dynamicform/" class=" ">Dynamicform</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/ontimize-web-ngx-dynamicform-builder/" class=" ">Dynamicform Builder</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/filemanager/" class=" ">File Manager</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/tree/" class=" ">Tree</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/gallery/" class=" ">Gallery</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/ontimize-web-ngx-jee-seed/" class=" ">JEE app seed</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/ontimize-web-ngx-seed/" class=" ">App seed</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/keycloak/" class=" ">Keycloak <span class='menuitem-badge'>new<span></a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/report/" class=" ">Report <span class='menuitem-badge'>new<span></a></li>
          
        </ul>
        
      </li>
    
    

      
       
      <li class="nav-component-category ">
        
          
            <span class="nav__sub-title"  onclick="onNavigationItemClick(this)"><i class="far fa-folder orange-icon nav__sub-title-icon"></i>Meta</span>
          

        

        
        <ul class="category-components-list">
          

          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/faq/" class=" ">FAQ</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/contributing/" class=" ">Contributing</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/license/" class=" ">License</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/versions/" class=" ">Versions</a></li>
          
            
            

            
            

            <li><a href="https://ontimizeweb.github.io/docs/v8/about/" class=" ">About</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>
    
  
  </div>


  <article class="page " itemscope itemtype="http://schema.org/CreativeWork">
    
    <meta itemprop="headline" content="Permissions example">
    
    <meta itemprop="description" content="     On This Page  ">
    
    <meta itemprop="datePublished" content="April 05, 2024">
    

    <div class="page__inner-wrap">
      
      <header>
        <h1 class="page__title" itemprop="headline">Permissions example
</h1>
        
      </header>
      

      <section class="page__content" itemprop="text">
        <aside class="sidebar__right">
<nav class="toc">
    <header><h4 class="nav__title"><i class="far fa-file-alt"></i> On This Page</h4></header>
<ul class="toc__menu" id="markdown-toc">
  <li><a href="#overview" id="markdown-toc-overview">Overview</a>    <ul>
      <li><a href="#first-steps" id="markdown-toc-first-steps">First steps</a></li>
    </ul>
  </li>
  <li><a href="#configuring-the-backend" id="markdown-toc-configuring-the-backend">Configuring the backend</a>    <ul>
      <li><a href="#candidate-entity-creation" id="markdown-toc-candidate-entity-creation">Candidate entity creation</a></li>
      <li><a href="#database-records" id="markdown-toc-database-records">Database records</a></li>
      <li><a href="#server-permissions" id="markdown-toc-server-permissions">Server permissions</a>        <ul>
          <li><a href="#creating-the-permission-service" id="markdown-toc-creating-the-permission-service">Creating the permission service</a></li>
          <li><a href="#defining-our-client-permissions" id="markdown-toc-defining-our-client-permissions">Defining our client permissions</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#configuring-the-frontend" id="markdown-toc-configuring-the-frontend">Configuring the frontend</a>    <ul>
      <li><a href="#application-configuration" id="markdown-toc-application-configuration">Application configuration</a></li>
      <li><a href="#route-permissions" id="markdown-toc-route-permissions">Route permissions</a></li>
    </ul>
  </li>
  <li><a href="#how-to-extend-the-permission-service" id="markdown-toc-how-to-extend-the-permission-service">How to extend the permission service</a></li>
</ul>

  </nav>
</aside>

<h1 id="overview">Overview</h1>

<p>In this section you are going to see the creation of an Ontimize application from cero using permissions on backend and frontend.</p>

<h2 id="first-steps">First steps</h2>

<p>This tutorial starts using an empty Ontimize application project and it is going to reach final configuration step by step. To see the complete example click the <a href="https://github.com/ontimize/ontimize-examples/tree/boot-web-permissions" target="_blank">following link</a>.</p>

<h1 id="configuring-the-backend">Configuring the backend</h1>

<h2 id="candidate-entity-creation">Candidate entity creation</h2>

<p>First, we are going to add all stuff related with a Candidate: an entity, a service and the rest controller as you can see <a href="https://www.ontimize.com/xwiki/bin/view/Ontimize+Boot+Training/Creating+DAO%2C+Service%2C+Controller" target="_blank">here</a>. Then, we will add records to our table candidate on the database.
Next step is to create the user <em>candidate</em> on the database and  define his permissions and the admin permissions as you can see <a href="https://ontimize.github.io/ontimize-boot/basics/security/" target="_blank">here</a>. In this example also you can see the tags that we use to secure the application and the methods. We use <code class="language-plaintext highlighter-rouge">@EnableAspectJAutoProxy(proxyTargetClass = false)</code> once on the <code class="language-plaintext highlighter-rouge">ServerAplication</code> class and <code class="language-plaintext highlighter-rouge">@Secured({ PermissionsProviderSecured.SECURED })</code> on all methods that you want to protect.</p>

<p><code class="language-plaintext highlighter-rouge">com.ontimize.projectwiki.ServerApplication</code>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SpringBootApplication</span>
<span class="nd">@EnableAspectJAutoProxy</span><span class="o">(</span><span class="n">proxyTargetClass</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ServerApplication</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">ServerApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
	<span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">com.ontimize.projectwiki.model.core.service.CandidateService</code>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="nd">@Secured</span><span class="o">({</span> <span class="nc">PermissionsProviderSecured</span><span class="o">.</span><span class="na">SECURED</span> <span class="o">})</span>
<span class="kd">public</span> <span class="nc">EntityResult</span> <span class="nf">candidateQuery</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">keyMap</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">attrList</span><span class="o">)</span>
        <span class="kd">throws</span> <span class="nc">OntimizeJEERuntimeException</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">daoHelper</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">candidateDao</span><span class="o">,</span> <span class="n">keyMap</span><span class="o">,</span> <span class="n">attrList</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="database-records">Database records</h2>

<p>Here are the rows that we added to our database on each table.</p>

<p><code class="language-plaintext highlighter-rouge">TUSER table:</code>
<img src="https://ontimizeweb.github.io/docs/v8/images/permissions/database_tuser.png" alt="TUSER table" class="align-center" /></p>

<p><code class="language-plaintext highlighter-rouge">TUSER_ROLE table</code>:
<img src="https://ontimizeweb.github.io/docs/v8/images/permissions/database_tuser_role.png" alt="TUSER table" class="align-center" /></p>

<p><code class="language-plaintext highlighter-rouge">TROLE table:</code>
<img src="https://ontimizeweb.github.io/docs/v8/images/permissions/database_trole.png" alt="TROLE table" class="align-center" /></p>

<p><code class="language-plaintext highlighter-rouge">TSERVER_PERMISSION table:</code>
<img src="https://ontimizeweb.github.io/docs/v8/images/permissions/database_tserver_permission.png" alt="TSERVER_PERMISSION table" class="align-center" /></p>

<p><code class="language-plaintext highlighter-rouge">TROLE_SERVER_PERMISSION table:</code>
<img src="https://ontimizeweb.github.io/docs/v8/images/permissions/database_trole_server_permission.png" alt="TROLE_SERVER_PERMISSION table" class="align-center" /></p>

<p>As we can see on the last screenshot the only user that have access to the CRUD operations on the table is the <code class="language-plaintext highlighter-rouge">demo</code> user.</p>

<h2 id="server-permissions">Server permissions</h2>

<p>Now it’s time to define the server permissions. In our application we have two users, ‘Demo’ and ‘Candidate’. The unique user that we want to have permission to access the candidates table is the ‘Demo’ user. So we will need to define it’s permissions.</p>

<h3 id="creating-the-permission-service">Creating the permission service</h3>

<p>Previous to define our permissions, we need to create a rest controller with its service to provide the permissions to the frontend.</p>

<p><code class="language-plaintext highlighter-rouge">com.ontimize.projectwiki.ws.core.rest.PermissionRestController</code>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/permissions"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PermissionRestController</span> <span class="kd">extends</span> <span class="nc">ORestController</span><span class="o">&lt;</span><span class="nc">IPermissionService</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">IPermissionService</span> <span class="n">permissionService</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">IPermissionService</span> <span class="nf">getService</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">permissionService</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">com.ontimize.projectwiki.model.core.service.PermissionService</code>:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span><span class="o">(</span><span class="s">"PermissionService"</span><span class="o">)</span>
<span class="nd">@Lazy</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PermissionService</span> <span class="kd">implements</span> <span class="nc">IPermissionService</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">CANDIDATE_PERMISSION</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">DEMO_PERMISSION</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="nf">readFromInputStream</span><span class="o">(</span><span class="nc">String</span> <span class="n">fileName</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="nc">StringBuilder</span> <span class="n">resultStringBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
        <span class="k">try</span> <span class="o">(</span><span class="nc">BufferedReader</span> <span class="n">br</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span>
                <span class="k">new</span> <span class="nf">InputStreamReader</span><span class="o">(</span><span class="nc">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getClassLoader</span><span class="o">().</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">fileName</span><span class="o">)))))</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">line</span><span class="o">;</span>
            <span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">br</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">resultStringBuilder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="s">"\n"</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">){</span>
            <span class="k">return</span> <span class="s">""</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">resultStringBuilder</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">PermissionService</span> <span class="o">(){</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="no">CANDIDATE_PERMISSION</span> <span class="o">=</span> <span class="n">readFromInputStream</span><span class="o">(</span><span class="s">"candidate_permissions.json"</span><span class="o">);</span>
            <span class="no">DEMO_PERMISSION</span> <span class="o">=</span> <span class="n">readFromInputStream</span><span class="o">(</span><span class="s">"demo_permissions.json"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">EntityResult</span> <span class="nf">permissionQuery</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">keyMap</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">attrList</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="nc">OntimizeJEERuntimeException</span> <span class="o">{</span>
        <span class="nc">Authentication</span> <span class="n">authentication</span> <span class="o">=</span> <span class="nc">SecurityContextHolder</span><span class="o">.</span><span class="na">getContext</span><span class="o">().</span><span class="na">getAuthentication</span><span class="o">();</span>
        <span class="nc">EntityResult</span> <span class="n">e</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">EntityResultMapImpl</span><span class="o">();</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="nc">String</span> <span class="n">role</span> <span class="o">=</span> <span class="n">authentication</span><span class="o">.</span><span class="na">getAuthorities</span><span class="o">().</span><span class="na">toArray</span><span class="o">()[</span><span class="mi">0</span><span class="o">].</span><span class="na">toString</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">role</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"candidate role"</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"permission"</span><span class="o">,</span> <span class="no">CANDIDATE_PERMISSION</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">role</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"admin"</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"permission"</span><span class="o">,</span> <span class="no">DEMO_PERMISSION</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">e</span><span class="o">.</span><span class="na">addRecord</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">e</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="defining-our-client-permissions">Defining our client permissions</h3>

<p>Client permissions are defined by a JSON file (you can find more detailed information  <a href="https://ontimizeweb.github.io/docs/v8/guide/permissions/#permissions-definition-example" target="_blank">here</a>).
In this turorial, we are going to create a set of simple preconfigured JSON permission files. Into a real application, this permission object could be retrived from database or created dynamically by code depending on the user, the role, etc. We can see more examples of this files</p>

<p><code class="language-plaintext highlighter-rouge">candidate_permissions.json</code>:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"menu"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"candidates"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"visible"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"routes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"permissionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"candidates-table-route"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">demo_permissions.json</code>:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"menu"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"candidates"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"visible"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"routes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"permissionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"candidates-table-route"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"components"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"candidate"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"selector"</span><span class="p">:</span><span class="w"> </span><span class="s2">"o-table"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"columns"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="nl">"attr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PHONE"</span><span class="p">,</span><span class="w"> </span><span class="nl">"visible"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="nl">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="nl">"attr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"delete"</span><span class="p">,</span><span class="w"> </span><span class="nl">"visible"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nl">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attr"</span><span class="p">:</span><span class="s2">"candidates_form_edit"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"selector"</span><span class="p">:</span><span class="w"> </span><span class="s2">"o-form"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"components"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="nl">"attr"</span><span class="p">:</span><span class="s2">"EMAIL"</span><span class="p">,</span><span class="nl">"visible"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="nl">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="nl">"attr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"delete"</span><span class="p">,</span><span class="w"> </span><span class="nl">"visible"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nl">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>With this permissions if we log into the application with the candidate user we will see the application like this:</p>

<p><img src="https://ontimizeweb.github.io/docs/v8/images/permissions/candidate_home.png" alt="candidate home" class="align-center" /></p>

<p>And if we log with de demo user we are going to see a different menu and we can enter to the candidate table:</p>

<p><img src="https://ontimizeweb.github.io/docs/v8/images/permissions/demo_home.png" alt="demo home" class="align-center" /></p>

<p>As we can see the <em>delete</em> button of the table is disabled as we configured before:</p>

<p><img src="https://ontimizeweb.github.io/docs/v8/images/permissions/demo_table.png" alt="demo home" class="align-center" /></p>

<p>And if we click on a row to edit the registry we can see that we can’t edit the email field:</p>

<p><img src="https://ontimizeweb.github.io/docs/v8/images/permissions/demo_edit.png" alt="demo home" class="align-center" /></p>

<h1 id="configuring-the-frontend">Configuring the frontend</h1>

<h2 id="application-configuration">Application configuration</h2>

<p>First file we need to configure on our frontend it’s the <code class="language-plaintext highlighter-rouge">app.config.ts</code> and add <code class="language-plaintext highlighter-rouge">permissionsServiceType</code> and <code class="language-plaintext highlighter-rouge">permissionsConfiguration</code> object. In <code class="language-plaintext highlighter-rouge">permissionsServiceType</code>, you define the type of permission to use (<em>OntimizeEEPermissions</em> or <em>OntimizePermissions</em>, for more information see <a href="https://ontimizeweb.github.io/docs/v8/guide/appconfig/#permissions-configuration" target="_blank">here</a>) and <code class="language-plaintext highlighter-rouge">permissionsConfiguration</code> which should contain the permissions service whose path should be defined in <code class="language-plaintext highlighter-rouge">app.services.config.ts</code> (defined in the following code section of this page).</p>

<p><code class="language-plaintext highlighter-rouge">app.config.ts</code>:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">CONFIG</span><span class="p">:</span> <span class="nx">Config</span> <span class="o">=</span> <span class="p">{</span>

<span class="p">...</span>

  <span class="na">permissionsServiceType</span><span class="p">:</span> <span class="dl">'</span><span class="s1">OntimizeEEPermissions</span><span class="dl">'</span><span class="p">,</span>

  <span class="na">permissionsConfiguration</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">service</span><span class="p">:</span> <span class="dl">'</span><span class="s1">permissions</span><span class="dl">'</span>
  <span class="p">}</span>

<span class="p">};</span>
</code></pre></div></div>

<p>Then we need to define our service on the <code class="language-plaintext highlighter-rouge">app.services.config.ts</code>. In our application we only got two services as we can see below.</p>

<p><code class="language-plaintext highlighter-rouge">app.services.config.ts</code>:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">SERVICE_CONFIG</span><span class="p">:</span> <span class="nb">Object</span> <span class="o">=</span> <span class="p">{</span>
  <span class="dl">'</span><span class="s1">candidates</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/candidates</span><span class="dl">'</span>
  <span class="p">},</span>
  <span class="dl">'</span><span class="s1">permissions</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/permissions/permission</span><span class="dl">'</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="route-permissions">Route permissions</h2>

<p>If we want to manage the routes permissions we need to define on the routing module the <code class="language-plaintext highlighter-rouge">canActivateChild</code> parameter and assign to it the Ontimize Web guard <code class="language-plaintext highlighter-rouge">PermissionsGuardService</code>.</p>

<p><code class="language-plaintext highlighter-rouge">main-routing.module.ts</code>:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">AuthGuardService</span><span class="p">,</span> <span class="nx">PermissionsGuardService</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">ontimize-web-ngx</span><span class="dl">'</span><span class="p">;</span>
<span class="p">...</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">routes</span><span class="p">:</span> <span class="nx">Routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
    <span class="na">component</span><span class="p">:</span> <span class="nx">MainComponent</span><span class="p">,</span>
    <span class="na">canActivate</span><span class="p">:</span> <span class="p">[</span><span class="nx">AuthGuardService</span><span class="p">],</span>
    <span class="na">canActivateChild</span><span class="p">:</span> <span class="p">[</span><span class="nx">PermissionsGuardService</span><span class="p">],</span>
    <span class="na">children</span><span class="p">:</span> <span class="p">[</span>
<span class="p">...</span>
</code></pre></div></div>

<p>Optionally the last configuration that we can do it’s to define a redirection page to visit when the user does not have permissions to access the page requested. To configure this page you need to add the route (or use the ontimize component <code class="language-plaintext highlighter-rouge">403</code>) to the <code class="language-plaintext highlighter-rouge">restrictedPermissionsRedirect</code> parameter on the routing module of the component or the module. Example:</p>

<p><code class="language-plaintext highlighter-rouge">candidates-routing.module.ts</code> (component):</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">routes</span><span class="p">:</span> <span class="nx">Routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span> <span class="na">component</span><span class="p">:</span> <span class="nx">CandidatesHomeComponent</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">oPermission</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">permissionId</span><span class="p">:</span> <span class="dl">'</span><span class="s1">candidates-table-route</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">restrictedPermissionsRedirect</span><span class="p">:</span> <span class="dl">'</span><span class="s1">403</span><span class="dl">'</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="dl">'</span><span class="s1">new</span><span class="dl">'</span><span class="p">,</span> <span class="na">component</span><span class="p">:</span> <span class="nx">CandidatesNewComponent</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">oPermission</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">permissionId</span><span class="p">:</span> <span class="dl">'</span><span class="s1">candidates-table-route</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">restrictedPermissionsRedirect</span><span class="p">:</span> <span class="dl">'</span><span class="s1">403</span><span class="dl">'</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="dl">'</span><span class="s1">:ID</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">component</span><span class="p">:</span> <span class="nx">CandidatesDetailComponent</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">oPermission</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">permissionId</span><span class="p">:</span> <span class="dl">'</span><span class="s1">candidates-table-route</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">restrictedPermissionsRedirect</span><span class="p">:</span> <span class="dl">'</span><span class="s1">403</span><span class="dl">'</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">];</span>
<span class="p">...</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">main-routing.module.ts</code> (module):</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">routes</span><span class="p">:</span> <span class="nx">Routes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
    <span class="na">component</span><span class="p">:</span> <span class="nx">MainComponent</span><span class="p">,</span>
    <span class="na">canActivate</span><span class="p">:</span> <span class="p">[</span><span class="nx">AuthGuardService</span><span class="p">],</span>
    <span class="na">canActivateChild</span><span class="p">:</span> <span class="p">[</span><span class="nx">PermissionsGuardService</span><span class="p">],</span>
    <span class="na">children</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span> <span class="na">redirectTo</span><span class="p">:</span> <span class="dl">'</span><span class="s1">home</span><span class="dl">'</span><span class="p">,</span> <span class="na">pathMatch</span><span class="p">:</span> <span class="dl">'</span><span class="s1">full</span><span class="dl">'</span> <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">path</span><span class="p">:</span> <span class="dl">'</span><span class="s1">home</span><span class="dl">'</span><span class="p">,</span> <span class="na">loadChildren</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">import</span><span class="p">(</span><span class="dl">'</span><span class="s1">./home/home.module</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">m</span> <span class="o">=&gt;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">HomeModule</span><span class="p">),</span>
        <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
          <span class="na">oPermission</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">restrictedPermissionsRedirect</span><span class="p">:</span> <span class="dl">'</span><span class="s1">403</span><span class="dl">'</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="p">{</span> <span class="na">path</span><span class="p">:</span> <span class="dl">'</span><span class="s1">candidates</span><span class="dl">'</span><span class="p">,</span> <span class="na">loadChildren</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">import</span><span class="p">(</span><span class="dl">'</span><span class="s1">./candidates/candidates.module</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">m</span> <span class="o">=&gt;</span> <span class="nx">m</span><span class="p">.</span><span class="nx">CandidatesModule</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">];</span>
<span class="p">...</span>
</code></pre></div></div>

<p>The page we will see if we try to access a page that we dont have permissions it’s going to look like this:</p>

<p><img src="https://ontimizeweb.github.io/docs/v8/images/permissions/access_denied.png" alt="demo home" class="align-center" /></p>

<h1 id="how-to-extend-the-permission-service">How to extend the permission service</h1>

<p>In case we want to change the permission service we need to do two steps:</p>
<ul>
  <li>Extend the <code class="language-plaintext highlighter-rouge">OntimizeEEPermissionsService</code> or the <code class="language-plaintext highlighter-rouge">OntimizePermissionsService</code> classes to your own service class. Example:</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">custom-permissions.service.ts</code>:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="p">@</span><span class="nd">Injectable</span><span class="p">()</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">CustomPermissionsService</span> <span class="kd">extends</span> <span class="nx">OntimizeEEPermissionsService</span> <span class="p">{</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="kr">protected</span> <span class="nx">injector</span><span class="p">:</span> <span class="nx">Injector</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">injector</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">loadPermissions</span><span class="p">():</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">isLoggedIn</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">authService</span><span class="p">.</span><span class="nx">isLoggedIn</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">isLoggedIn</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">super</span><span class="p">.</span><span class="nx">loadPermissions</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">loadPublicPermissions</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">loadPublicPermissions</span><span class="p">():</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">../../assets/dummy/public-permission.json</span><span class="dl">'</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nb">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="kd">const</span> <span class="na">dataObservable</span><span class="p">:</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Observable</span><span class="p">(</span><span class="nx">_innerObserver</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nb">self</span><span class="p">.</span><span class="nx">httpClient</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">url</span><span class="p">).</span><span class="nx">subscribe</span><span class="p">((</span><span class="na">res</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">permissions</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="k">if</span> <span class="p">((</span><span class="nx">res</span><span class="p">.</span><span class="nx">code</span> <span class="o">===</span> <span class="nx">Codes</span><span class="p">.</span><span class="nx">ONTIMIZE_SUCCESSFUL_CODE</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">Util</span><span class="p">.</span><span class="nx">isDefined</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">))</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">((</span><span class="nx">response</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">Util</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">response</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
              <span class="nx">permissions</span> <span class="o">=</span> <span class="nx">response</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="dl">'</span><span class="s1">[OntimizeEEPermissionsService: permissions parsing failed]</span><span class="dl">'</span><span class="p">);</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
        <span class="nx">_innerObserver</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">permissions</span><span class="p">);</span>

      <span class="p">},</span> <span class="nx">error</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">_innerObserver</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
      <span class="p">},</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">_innerObserver</span><span class="p">.</span><span class="nx">complete</span><span class="p">());</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="nx">dataObservable</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">share</span><span class="p">());</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>And here are the permissions loaded  if the user is not logged in:</p>

<p><code class="language-plaintext highlighter-rouge">public-permission.json</code>:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"menu"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"candidates"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"visible"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"attr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"home"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"visible"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"routes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"permissionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"candidates-table-route"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"permissionId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"home-route"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>Add the service to your <code class="language-plaintext highlighter-rouge">app.module.ts</code> file. Example:</li>
</ul>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">...</span>
<span class="p">,</span>
  <span class="nx">providers</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="na">provide</span><span class="p">:</span> <span class="nx">APP_CONFIG</span><span class="p">,</span> <span class="na">useValue</span><span class="p">:</span> <span class="nx">CONFIG</span> <span class="p">},</span>
    <span class="nx">ONTIMIZE_PROVIDERS</span><span class="p">,</span>
    <span class="p">{</span> <span class="na">provide</span><span class="p">:</span> <span class="nx">O_PERMISSION_SERVICE</span><span class="p">,</span> <span class="na">useValue</span><span class="p">:</span> <span class="nx">CustomPermissionsService</span> <span class="p">},</span>
    <span class="p">...</span><span class="nx">customProviders</span>
  <span class="p">],</span>
<span class="p">})</span>
<span class="k">export</span> <span class="kd">class</span> <span class="nx">AppModule</span> <span class="p">{</span> <span class="p">}</span>
</code></pre></div></div>

        
      </section>

      <footer class="page__meta">
        
        




        
        <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2024-04-05T03:41:07-04:00">April 05, 2024</time></p>
        
      </footer>

      

      <!-- 


  <nav class="pagination">
    
      <a href="https://ontimizeweb.github.io/docs/v8/guide/permissions/" class="pagination--pager" title="Permissions
">
          <i class="fas fa-arrow-left margin-right"></i>
        Previous
      </a>
    
    
      <a href="https://ontimizeweb.github.io/docs/v8/run-your-app/" class="pagination--pager" title="Run your application
">
        Next
        <i class="fas fa-arrow-right margin-left"></i>
      </a>
    
  </nav>
 -->
    </div>

    
  </article>

  
  
</div>

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<a href="#" class="scrollToTop"><i class="fa fa-fw fa-chevron-circle-up" aria-hidden="true"></i></a>

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/imatiainnova" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
      <li><a href="https://www.linkedin.com/company/224080?trk=prof-0-ovw-curr_pos" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
    
    
      <li><a href="http://github.com/OntimizeWeb" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="https://ontimizeweb.github.io/docs/v8/feed.xml" target="_blank"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 Imatia Innovation, S.L.. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="https://ontimizeweb.github.io/docs/v8/assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2011187-3', 'auto');
  ga('send', 'pageview');
</script>






  </body>
</html>
